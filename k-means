import matplotlib.pyplot as plt
from sklearn.datasets import load_iris
from sklearn.cluster import KMeans
import sklearn.metrics as sm
import pandas as pd
import numpy as np

# Load data
iris = load_iris()
X = pd.DataFrame(iris.data, columns=['Sepal_Length','Sepal_Width','Petal_Length','Petal_Width'])
y = pd.DataFrame(iris.target, columns=['target'])

colormap = np.array(['red','lime','black'])

# Plot real classification
plt.figure(figsize=(14,6))
plt.subplot(1,2,1)
plt.scatter(X.Sepal_Length, X.Sepal_Width, c=colormap[y.target], s=40)
plt.title('Sepal (Real)')

plt.subplot(1,2,2)
plt.scatter(X.Petal_Length, X.Petal_Width, c=colormap[y.target], s=40)
plt.title('Petal (Real)')
plt.show()

# K-Means Model
model = KMeans(n_clusters=3, random_state=0).fit(X)

# Compare Real vs Predicted
plt.figure(figsize=(14,6))
plt.subplot(1,2,1)
plt.scatter(X.Petal_Length, X.Petal_Width, c=colormap[y.target], s=40)
plt.title('Real Classification')

plt.subplot(1,2,2)
plt.scatter(X.Petal_Length, X.Petal_Width, c=colormap[model.labels_], s=40)
plt.title('K-Means Classification')
plt.show()

# Evaluation
print("Accuracy:", sm.accuracy_score(y, model.labels_))
print("\nConfusion Matrix:\n", sm.confusion_matrix(y, model.labels_))
print("\nClassification Report:\n", sm.classification_report(y, model.labels_))
